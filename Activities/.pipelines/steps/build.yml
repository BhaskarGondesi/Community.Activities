parameters:
  BuildProject: ""
  BuildConfiguration: "Release"
  BuildPlatform: "AnyCPU"
  NuGetVersionSpec: "4.3.0"
  NuGetConfigPath: "$(Build.SourcesDirectory)/Activities/.nuget/NuGet.Config"
  Dependencies: []
  restoreDependencies: []
  rootPath: $(Build.SourcesDirectory)
  packagesDirectory: ""
  versionNumber: ""
  versionSuffix: ""

steps:
#- ${{ each depend in parameters.restoreDependencies }}:
 - task: DotNetCoreCLI@2@2
   displayName: "dotnet Restore Nuget packages"
   inputs:
     command:            "restore"
     feedsToUse:         "config"
     projects:           "**/*.csproj"
     includeNuGetOrg:    true
     nugetConfigPath:    ${{ parameters.NuGetConfigPath }}
     packDirectory:      ${{ parameters.packagesDirectory }}

# - task: DotNetCoreCLI@2@2
#   displayName: "dotnet Restore Nuget packages ${{ parameters.BuildProject }}"
#   inputs:
#     restoreSolution:    ${{ format('{0}{1}', parameters.rootPath, parameters.BuildProject) }}
#     feedsToUse:         "config"
#     nugetConfigPath:    ${{ parameters.NuGetConfigPath }}
#     packagesdirectory:  ${{ parameters.packagesDirectory }}

 - task: VSBuild@1
   displayName: "Build Solution ${{ parameters.BuildProject }}"
   inputs:
     solution:       ${{ format('{0}{1}', parameters.rootPath, parameters.BuildProject) }}
     platform:       ${{ parameters.BuildPlatform }}
     configuration:  ${{ parameters.BuildConfiguration }}
     msbuildArgs:    '/p:Version=$(versionNumber)$(versionSuffix)'
 